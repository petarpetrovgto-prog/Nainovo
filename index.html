<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Range Trainer vT7</title>
<style>
  :root{
    --bg:#0b0f14; --panel:#0f1520; --panel2:#101827; --border:#223047; --text:#e7ecf3;
    --FOLD:#f4f6fa; --L-F-F:#a7e8a7; --L-C-F:#155d15; --L-C-AI:#bcdcf3; --L-R-AI:#0b3a94;
    --MR-F-F:#ffe27a; --MR-C-AI:#7b4a2a; --MR-4B-AI:#e44747; --SHOVE:#6d4b8e;
    --ok:#1f9d55; --err:#d64545;
  }
  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
  body{margin:0;background:var(--bg);color:var(--text);font:16px/1.35 -apple-system,system-ui,Segoe UI,Roboto,Arial}
  .top{position:sticky;top:0;z-index:30;display:flex;justify-content:space-between;align-items:center;
       padding:6px 8px;background:var(--panel2);border-bottom:1px solid var(--border)}
  .chip{padding:3px 8px;border:1px solid var(--border);border-radius:999px;background:#0f1624;font-size:12px}
  .btn{border:1px solid var(--border);background:#0f1624;color:var(--text);border-radius:12px;
       padding:10px 14px;font-weight:800;cursor:pointer}
  .wrap{max-width:1100px;margin:0 auto;padding:10px}
  .grid{display:grid;gap:10px}
  @media(min-width:980px){.grid{grid-template-columns:1.1fr 0.9fr}}
  .card{border:1px solid var(--border);background:#0f1624;border-radius:14px;padding:12px}
  .card h3{margin:0 0 8px;font-size:16px;display:flex;align-items:center;justify-content:space-between}
  .toggle{font-size:12px;opacity:.9}
  .hidden{display:none}

  .qTop{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px}
  .qHand{font-size:26px;font-weight:900}

  /* –¥–µ–π—Å—Ç–≤–∏—è */
  .actionsGrid{
    display:grid;
    grid-template-columns:repeat(3, minmax(0,1fr));
    gap:10px;
  }
  .actBtn{
    position:relative;border:2px solid rgba(0,0,0,.18);border-radius:13px;
    padding:16px 10px;font-size:16px;font-weight:1000;letter-spacing:.3px;
    color:#000; box-shadow:0 4px 14px rgba(0,0,0,.25);
    transform:translateY(0); transition:transform .06s ease, filter .06s ease, box-shadow .06s ease;
  }
  .actBtn:active{transform:translateY(1px); filter:brightness(.96)}
  .actBtn.ok{box-shadow:0 0 0 3px rgba(31,157,85,.55)}
  .actBtn.err{box-shadow:0 0 0 3px rgba(214,69,69,.55)}
  .actBtn .lbl{
    display:block;
    white-space:normal;
    overflow-wrap:anywhere;
    line-height:1.05;
  }
  .tag{position:absolute;right:8px;top:6px;font-size:11px;opacity:.7;color:#000}

  /* keypad (–∑–∞ PUSH) */
  .disp{margin:4px 0 8px;border:2px solid var(--border);background:#0b1220;border-radius:10px;padding:10px;
        font-weight:900;text-align:center}
  .disp.ok{border-color:var(--ok); box-shadow:0 0 0 3px rgba(31,157,85,.45)}
  .disp.err{border-color:var(--err); box-shadow:0 0 0 3px rgba(214,69,69,.45)}
  .keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
  .key{border:1px solid var(--border);background:#111a2b;border-radius:12px;padding:16px 0;font-weight:900;font-size:20px}
  .key.wide{grid-column:span 2}

  .feedback{margin-top:10px;font-weight:900}
  .ok{color:var(--ok)} .err{color:var(--err)}
  .resRow{display:flex;justify-content:space-between;gap:8px;align-items:center;padding:8px 10px;
          border:1px dashed #2a3b58;border-radius:10px;margin-top:8px}
  .val{font-weight:900;padding:6px 8px;border-radius:8px;min-width:96px;text-align:center}

  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px}
  .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--border);background:#0f1624;
         border-radius:999px;padding:6px 10px;font-weight:800;cursor:pointer}
  .badge input{accent-color:#4da3ff}
  .mini{font-size:12px;opacity:.8}
  .sep{height:1px;background:#223047;margin:10px 0}

  /* –º–æ–¥–∞–ª–∏ */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;z-index:60;align-items:center;justify-content:center;padding:16px}
  .overlay.show{display:flex}
  .box{width:100%;max-width:680px;background:#0f1520;border:1px solid var(--border);border-radius:14px;overflow:hidden}
  .boxHead{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:#101827;border-bottom:1px solid var(--border)}
  .boxBody{padding:10px 12px}
  .boxFoot{display:flex;gap:8px;justify-content:space-between;padding:10px 12px;border-top:1px solid var(--border);background:#0f1520}
  textarea{width:100%;min-height:260px;background:#0b1220;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:10px;font:14px/1.35 ui-monospace}

  /* –ñ–æ–∫–µ—Ä */
  #jokerPanel{margin-top:12px;padding:10px;border:1px dashed #2a3b58;border-radius:10px}
  #jokerContent{margin-top:8px;max-height:300px;overflow:auto}

  /* --- –ú–æ–±–∏–ª–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞ iPhone 15 Pro Max (430px) –∏ –Ω–∞–¥–æ–ª—É --- */
  @media (max-width: 480px){
    .grid{gap:8px}
    .actionsGrid{gap:8px}
    .actBtn{padding:12px 6px;font-size:14px;border-radius:12px}
    .tag{top:4px;right:6px;font-size:10px}
  }
  @media (max-width: 380px){
    .actBtn{padding:10px 6px;font-size:13px}
  }
</style>
</head>
<body>
<div class="top">
  <div>
    <span class="chip">Q: <b id="qCount">0</b></span>
    <span class="chip">‚úî: <b id="qRight">0</b></span>
    <span class="chip">üî•: <b id="streak">0</b></span>
  </div>
  <div>
    <button class="btn" id="btnEdit">–†–µ–¥–∞–∫—Ç–æ—Ä</button>
    <button class="btn" id="btnData">Import/Export</button>
  </div>
</div>

<div class="wrap grid">
  <!-- QUIZ -->
  <div class="card">
    <h3>–¢–µ—Å—Ç</h3>
    <div class="qTop">
      <div class="qHand" id="qHand">‚Äî</div>
      <div id="qStack">–°—Ç–∞–∫: ‚Äî</div>
      <div id="qPos">–ü–æ–∑–∏—Ü–∏—è: ‚Äî</div>
    </div>

    <div id="ansArea"></div>

    <div id="feedback" class="feedback"></div>
    <div id="correctRow" class="resRow" style="display:none">
      <div>–ü—Ä–∞–≤–∏–ª–µ–Ω:</div>
      <div id="correctVal" class="val">‚Äî</div>
    </div>

    <!-- –ñ–æ–∫–µ—Ä -->
    <div id="jokerPanel" style="display:none">
      <button id="btnJokerSwitch" class="btn" style="width:100%">–°–º–µ–Ω–∏ –∂–æ–∫–µ—Ä–∞</button>
      <div id="jokerContent"></div>
    </div>

    <div style="display:flex;gap:8px;margin-top:12px">
      <button id="btnCheck" class="btn" style="flex:1;font-weight:900">–ü—Ä–æ–≤–µ—Ä–∏</button>
      <button id="btnNext" class="btn" style="flex:1;font-weight:900">–°–ª–µ–¥–≤–∞—â</button>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="card" id="settingsCard">
    <h3>
      –ù–∞—Å—Ç—Ä–æ–π–∫–∏
      <button id="toggleSettings" class="btn toggle">–°–∫—Ä–∏–π</button>
    </h3>
    <div class="mini">–ü–æ–∑–∏—Ü–∏–∏ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–º–∞—Ä–∫–∏—Ä–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏):</div>
    <div id="posFilters" class="row"></div>
    <div class="sep"></div>
    <div class="mini">–°—Ç–∞–∫ –¥–∏–∞–ø–∞–∑–æ–Ω–∏ (–º–∞—Ä–∫–∏—Ä–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏):</div>
    <div id="stkFilters" class="row"></div>
    <div class="sep"></div>
    <div class="row">
      <button id="btnStart" class="btn" style="flex:1;font-weight:900">–°—Ç–∞—Ä—Ç / –†–µ—Å—Ç–∞—Ä—Ç</button>
      <button id="btnResetScore" class="btn" style="flex:1;font-weight:900">–ù—É–ª–∏—Ä–∞–π —Ä–µ–∑—É–ª—Ç–∞—Ç</button>
    </div>
  </div>
</div>

<!-- EDITOR -->
<div id="editModal" class="overlay">‚Ä¶</div>
<!-- DATA IO -->
<div id="dataModal" class="overlay">‚Ä¶</div>

<script>
(function(){
  // --- —Ç–≤–æ—è –ø—ä–ª–µ–Ω JS —Ç—É–∫ ---
  // (–Ω–µ —Å—ä–º –ø–∏–ø–∞–ª –Ω–∏—Ç–æ –µ–¥–Ω–∞ –±—É–∫–≤–∞, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ö showJoker –∏ –ª–æ–≥–∏–∫–∞ –∑–∞ –±—É—Ç–æ–Ω–∞)

  // >>> –¥–æ–±–∞–≤–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ñ–æ–∫–µ—Ä <<<
  let jokerType = localStorage.getItem("jokerType") || "matrix";
  function showJoker(pos,stk){
    const panel=document.getElementById("jokerPanel");
    const cont=document.getElementById("jokerContent");
    panel.style.display="block";
    if(jokerType==="matrix"){
      cont.innerHTML="<b>13x13 —Ç–∞–±–ª–∏—Ü–∞ (–ø—Ä–∏–º–µ—Ä)</b><br>[—Ç—É–∫ —Å–µ —Ä–∏—Å—É–≤–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å–ø–æ—Ä–µ–¥ –¥–∞–Ω–Ω–∏—Ç–µ]";
    }else if(jokerType==="list"){
      cont.innerHTML="<ul><li>–ó–∞–ø–æ–º–Ω–∏: —Å–∏–ª–Ω–∏—Ç–µ —Ä—ä—Ü–µ –≤–∏–Ω–∞–≥–∏ –∞–≥—Ä–µ—Å–∏—è</li><li>–°—Ä–µ–¥–Ω–∏—Ç–µ ‚Äì —Å–∏—Ç—É–∞—Ç–∏–≤–Ω–æ</li></ul>";
    }else if(jokerType==="mnemo"){
      cont.innerHTML="–ú–Ω–µ–º–æ–Ω–∏–∫–∞: <b>ABC = Always Bet Connectors</b>";
    }
  }
  document.getElementById("btnJokerSwitch").onclick=()=>{
    jokerType = jokerType==="matrix"?"list":(jokerType==="list"?"mnemo":"matrix");
    localStorage.setItem("jokerType",jokerType);
    if(curQ) showJoker(curQ.pos,curQ.stk);
  };

  // >>> –≤ checkAnswer —Å–ª–µ–¥ –ø–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª–Ω–∏—è –æ—Ç–≥–æ–≤–æ—Ä –¥–æ–±–∞–≤–∏:
  // showJoker(curQ.pos,curQ.stk);

})();
</script>
</body>
</html>
